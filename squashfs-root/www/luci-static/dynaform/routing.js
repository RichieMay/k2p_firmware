function load(a,b,c){var d={enter:function(c){var d=c.async(),f=this.name;loadPage(a+".htm",b,function(){d();$("a[data-active]").each(function(){if(0<=f.indexOf($(this).attr("data-active"))){$(this).addClass("active");var a=$(this).find("i.icon");a.addClass(a.attr("data-down"))}else $(this).removeClass("active"),a=$(this).find("i.icon"),a.removeClass(a.attr("data-down"))})})},leave:function(){$(".close-btn").click()}};!1!==c&&(d.update=function(c){loadPage(a+".htm",b)});return d}
var stateman=new StateMan,h5States={login:load("login","Con"),phone:load("menu","Con",!1),"phone.netState":load("netState","Content"),wifiList:load("wifiList","Con"),"phone.deviceManage":load("deviceManage","Content"),editClient:load("editClient","Con"),"phone.wifiSet":load("wifiConfig","Content"),"phone.App":load("App","Content"),networkset:load("networkSet","Con"),guest:load("guest","Con"),parentCtrl:load("parentCtrl","Con"),devList:load("devList","Con"),parentCtrlRule:load("parentCtrlRule","Con"),
parentCtrlAddRule:load("parentCtrlAddRule","Con"),diagnose:load("diagnose","Con"),wisp:load("wisp","Con"),apList:load("apList","Con"),setExtend:load("setExtend","Con"),remoteMng:load("remoteMng","Con"),screenSet:load("screenSet","Con"),modifyPwd:load("modifyPwd","Con"),lanSet:load("lanSet","Con"),sysUpgrade:load("sysUpgrade","Con"),light:load("light","Con"),timeZone:load("timeZone","Con"),signalCondition:load("signalCondition","Con"),timeSleep:load("timeSleep","Con"),whiteList:load("whiteList","Con"),
timeReboot:load("timeReboot","Con")},pcStates={login:load("login","Con"),pc:load("menu","Con",!1),"pc.netState":load("netState","Content"),"pc.wifiSet":load("wifiConfig","Content"),"pc.App":load("App","Content"),"pc.deviceManage":load("deviceManage","Content"),"pc.networksetApp":load("networkSet","Content"),"pc.guestApp":load("guest","Content"),"pc.parentCtrlApp":load("parentCtrl","Content"),"pc.diagnoseApp":load("diagnose","Content"),"pc.screenSetApp":load("screenSet","Content"),"pc.wispApp":load("wisp",
"Content"),"pc.setExtendApp":load("setExtend","Content"),"pc.remoteMngApp":load("remoteMng","Content"),"pc.signalSetApp":load("signalSet","Content"),"pc.lanSetApp":load("lanSet","Content"),"pc.sysUpgradeApp":load("sysUpgrade","Content"),"pc.ddnsApp":load("ddns","Content"),"pc.routerInfoApp":load("routerInfo","Content"),"pc.usbStorageApp":load("usbStorage","Content"),"pc.dmzApp":load("dmz","Content"),"pc.backupResetApp":load("backupReset","Content"),"pc.dhcpServerApp":load("dhcp","Content"),"pc.shoppingPriceApp":load("shopPrice",
"Content"),"pc.autoUpgradeApp":load("sysUpgrade","Content"),"pc.manualUpgradeApp":load("manualUpgrade","Content"),"pc.remotePrinterApp":load("printer","Content"),"pc.safeMngApp":load("safeMng","Content"),"pc.UPnPApp":load("upnp","Content"),"pc.portForwadApp":load("portForwad","Content"),"pc.QoSApp":load("qos","Content"),"pc.timeZoneApp":load("timeZone","Content"),"pc.VPNClientApp":load("vpnClient","Content"),"pc.VPNServerApp":load("vpnServer","Content"),"pc.wdsApp":load("wds","Content"),"pc.setLanApp":load("setLan",
"Content"),"pc.setMainApp":load("setMain","Content"),"pc.setSubApp":load("setSub","Content"),"pc.lightApp":load("light","Content"),"pc.gameApp":load("game","Content"),"pc.signalConditionApp":load("signalCondition","Content"),"pc.timeSleepApp":load("timeSleep","Content"),"pc.whiteListApp":load("whiteList","Content"),"pc.elinkApp":load("elink","Content"),"pc.urlBlockApp":load("urlBlock","Content"),
  "pc.freesocksApp":load("freesocks","Content"),
  "pc.adbApp":load("adb","Content"),
  "pc.adbsetApp":load("adbset","Content"),
  "pc.kmsApp":load("kms","Content"),
  "pc.freesocksSetApp":load("freesocksSet","Content"),
  "pc.toolsApp":load("tools","Content"),
  "pc.syslogApp":load("syslog","Content"),
  "pc.iptvApp":load("iptv","Content"),
  "pc.ipv6App":load("ipv6","Content"),
  "pc.modeSwitchApp":load("modeSwitch",
"Content"),"pc.woLinkApp":load("woLink","Content"),"pc.igmpApp":load("igmp","Content"),"pc.schemeUpgrade":function(){showLoading(label.versionChecking);apiGet({system:{upgrade_info:{action:"upgrade"}}},function(a){E_NONE==a[ERR_CODE]&&$.setTimeout(upgradeStatus,1E3)})}},pcSetStates={login:load("login","Con"),guideTimeZone:load("guideTimeZone","Con"),guideNetworkSet:load("guideNetworkSet","Con"),guideWifiSet:load("guideWifiSet","Con"),checkRouterLink:load("checkRouterLink","Con"),findPppoePwd:load("findPppoePwd",
"Con")},h5SetStates={login:load("login","Con"),guideTimeZone:load("guideTimeZone","Con"),guideNetworkSet:load("guideNetworkSet","Con"),guideWifiSet:load("guideWifiSet","Con"),checkRouterLink:load("checkRouterLink","Con"),findPppoePwd:load("findPppoePwd","Con")},pcGuideStates={guide:load("guide","Con")},h5GuideStates={guide:load("guide","Con"),userAgreement:load("userAgreement","Con")},pcPwdStates={setLgPwd:load("setLgPwd","Con")},h5PwdStates={setLgPwd:load("setLgPwd","Con")};
function addState(a,b){for(var c in b)a[c]=b[c]}
function resetState(){stateman.stop();stateman=new StateMan;var a=pcGuideStates,b="";apiGetWithUrl("/welcome/getconfig",{welcome:{config:null}},function(c){var d=c.module.factory,e=c.module.guide;c=c.module.agreement;0==c?(a=OS.mobile?h5GuideStates:pcGuideStates,b="guide"):1==c&&1==d?(a=OS.mobile?h5PwdStates:pcPwdStates,b="setLgPwd"):1==e?(a=OS.mobile?h5SetStates:pcSetStates,b=ROUTER.guideList[1]):OS.mobile?(a=h5States,b="phone.netState"):(a=pcStates,b="pc.netState");stateman.state(a).on("notfound",
function(){this.go(b)}).on("reset",function(){resetState()});stateman.start()})}stateman.on("reset",function(){resetState()});
if(OS.mobile)if(0==ROUTER.agreement)stateman.state(h5GuideStates).on("notfound",function(){this.go("guide")});else if(1==ROUTER.agreement&&1==ROUTER.factory)stateman.state(h5PwdStates).on("notfound",function(){this.go("setLgPwd")});else if(1==ROUTER.guide)stateman.state(h5SetStates).on("notfound",function(){this.go(ROUTER.guideList[1])});else stateman.state(h5States).on("notfound",function(){this.go("phone.netState")});else if(0==ROUTER.agreement)stateman.state(pcGuideStates).on("notfound",function(){this.go("guide")});
else if(1==ROUTER.agreement&&1==ROUTER.factory)stateman.state(pcPwdStates).on("notfound",function(){this.go("setLgPwd")});else if(1==ROUTER.guide)stateman.state(pcSetStates).on("notfound",function(){this.go(ROUTER.guideList[1])});else stateman.state(pcStates).on("notfound",function(){this.go("pc.netState")});var upgradeStatusHd=null;
function upgradeStatus(){apiGet({system:{upgrade_info:{action:"upgrade_status"}}},function(a){var b=a[K_MODULE].system.upgrade_info;a=b.running_status;b=parseInt(b.status_code,10);if(4==a)0==b&&(clearTimeout(upgradeStatusHd),showProgressBar(label.upgrading,label.upgradingTips,ROUTER.time.onlineUpgrade,function(){window.location.href="http://"+ROUTER.domain}),$.setTimeout(function(){lanDetecting(function(){window.location.href="http://"+ROUTER.domain})},ROUTER.time.detectDelay));else if(0==a)clearTimeout(upgradeStatusHd),
showAlert(label.upgradeFailed);else switch(b){case 0:showStatus(a);upgradeStatusHd=$.setTimeout(upgradeStatus,1E3);break;default:clearTimeout(upgradeStatusHd),showAlert(label.upgradeFailed)}})}function showStatus(a){1==a?showLoading(label.versionChecking):2==a?showLoading(label.downloadingTip):3==a&&showLoading(label.upgradeChecking)};
