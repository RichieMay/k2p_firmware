function Checks(){this.validIpAddr=function(a,b){for(var c=a.split("."),d=1,e=c.length;d<e;d++)if(255<c[d])return E_INVIPFMT;return void 0!=b&&!0==b.unCheckAll0IP||"0.0.0.0"!=a?void 0!=b&&!0==b.unCheckAll1IP||"255.255.255.255"!=a?(void 0==b||!0!=b.unCheckMutiIp)&&224<=c[0]&&239>=c[0]?E_INVGROUPIP:void 0!=b&&!0==b.unCheckLoopIp||127!=c[0]?(void 0==b||!0!=b.unCheckReserveIP)&&240<=c[0]&&255>=c[0]?E_INVRESERVEIP:E_NONE:E_INVLOOPIP:E_INVALL1IP:E_INVALL0IP};this.validIpFormat=function(a){return!0==/^(?:(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\.){3}(?:(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9]))$/g.test(a)?
E_NONE:E_INVIPFMT};this.checkIp=function(a,b){return 0==a.length?E_BLANK:E_NONE!=this.validIpFormat(a)?E_INVIPFMT:E_NONE!=this.validIpAddr(a,b)?E_INVIP:E_NONE};this.validMacAddr=function(a,b){var c=a.toLowerCase();return void 0!=b&&!0==b.unCheckAll0Mac||"00:00:00:00:00:00"!=c?void 0!=b&&!0==b.unCheckAll1Mac||"ff:ff:ff:ff:ff:ff"!=c?void 0!=b&&!0==b.unCheckGroupMac||1!="0123456789abcdef".indexOf(c.charAt(1))%2?E_NONE:E_INVMACGROUP:E_INVMACBROAD:E_INVMACZERO};this.validMacFormat=function(a){return!0==
/^([0-9a-f]{2}:){5}([0-9a-f]{2})$/gi.test(a)?E_NONE:E_INVMACFMT};this.checkMac=function(a,b){return 0==a.length?E_BLANK:E_NONE!=this.validMacFormat(a)?E_INVMACFMT:E_NONE!=this.validMacAddr(a,b)?E_INVMAC:E_NONE};this.validMaskFormat=function(a){var b=1;a=this.transIp(a);for(var c=0;32>c;c++,b<<=1)if(0!=(b&a))return 0==(a^4294967295<<c)?E_NONE:E_INVMASKFMT};this.validMask=function(a,b){var c=this.transIp(a);return(void 0==b||!0!=b.unCheckAll0Mask)&&0==c||(void 0==b||!0!=b.unCheckAll1Mask)&&4294967295==
c?E_INVMASK:E_NONE};this.checkMask=function(a){return 0==a.length?E_BLANK:E_NONE!=this.validIpFormat(a)||E_NONE!=validMaskFormat(a)?E_INVMASKFMT:E_NONE!=this.validMask(a)?E_INVMASK:E_NONE};this.checkMtu=function(a,b,c){if(!1==this.checkNum(a))return E_INVMTUSTATIC;void 0==b&&(b=1500,c=576);return!1==this.checkNumRange(parseInt(a),b,c)?E_INVMTUSTATIC:E_NONE};this.checkIpMask=function(a,b){var c=this.transIp(b),d=this.transIp(a),c=this.checkIPNetHost(d,c);return c!=E_NONE?c:E_NONE};this.transIp=function(a){a=
a.split(".");return 16777216*a[0]+65536*a[1]+256*a[2]+1*a[3]};this.getCNStrLen=function(a){return a.replace(/[^\x00-\xFF]/g,"xxx").length};this.getIpClass=function(a){a=a.split(".");return 127>=a[0]?"A":191>=a[0]?"B":223>=a[0]?"C":239>=a[0]?"D":"E"};this.checkNum=function(a){return""==a?!1:!/\D/g.test(a)};this.checkNumNew=function(a,b,c){a=a.toString();return""==a?E_BLANK:/^(?:(0|[1-9]\d*))$/.test(a)?a<b||a>c?E_NUMRANGE:E_NONE:E_NUMFORMAT};this.checkIPNetHost=function(a,b){return 0==(a&~b)||~b==(a&
~b)?E_INVHOSTID:E_NONE};this.checkIpClass=function(a,b){var c=this.getIpClass(a),d=this.transIp(a),e=this.transIp(b);switch(c){case "A":d&=4278190080;break;case "B":d&=4294901760;break;case "C":d&=4294967040}return e>d?E_NONE:E_INVIPMASKPAIR};this.checkStrLen=function(a,b,c){a=this.getCNStrLen(a);return c>a||b<a?E_STRINGLEN:E_NONE};this.checkNumRange=function(a,b,c){return isNaN(a)||a<c||a>b?!1:!0};this.checkSsid=function(a){var b=getCNStrLen(a);return""==a?E_SSID_BLANK:1>b||32<b?E_SSID_LEN:E_NONE};
this.checkWlanPwd=function(a){var b=getCNStrLen(a);return!1==checkIllegalChar(a)?E_WIFI_PWD_ILLEGAL:63<b||8>b?E_WIFI_PWD_LEN:E_NONE};this.checkIllegalChar=function(a){for(var b,c=0,d=a.length;c<d;c++)if(b=a.charAt(c),-1=="0123456789ABCDEFabcdefGHIJKLMNOPQRSTUVWXYZghijklmnopqrstuvwxyz`~!@#$^&*()-=_+[]{};:'\"\\|/?.,<>/% ".indexOf(b))return!1;return!0};this.checkStr=function(a,b){if("decNumChar"==b&&/\D/g.test(a)||"hexNumChar"==b&&!/^[0-9a-f]+$/gi.test(a))return!1;if(void 0==b||"enChar"==b)for(var c,
d=0,e=a.length;d<e;d++)if(c=a.charAt(d),-1=="0123456789ABCDEFabcdefGHIJKLMNOPQRSTUVWXYZghijklmnopqrstuvwxyz`~!@#$^&*()-=_+[]{};:'\"\\|/?.,<>/% ".indexOf(c))return!1;return"numAndLetters"==b&&!/^[0-9a-z]+$/gi.test(a)||"enChar2"==b&&!/^[0-9a-z_]+$/gi.test(a)?!1:!0};this.checkStrFormat=function(a,b){return"string"!=typeof a?E_STRINGILLEGAL:""==a?E_STRINGBLANK:checkStr(a,b)?E_NONE:E_STRINGFORMAT};this.checkGateway=function(a){return E_NONE!=checkIp(a)?E_INVGTW:E_NONE};this.checkPrimDns=function(a){return E_NONE!=
checkIp(a)?E_INVFDNSIP:E_NONE};this.checkSeDns=function(a,b){return""==a?E_NONE:E_NONE!=checkIp(a)?E_INVSDNSIP:E_NONE};this.checkSameNetwork=function(a,b,c){a="number"==typeof a?a:this.transIp(a);b="number"==typeof b?b:this.transIp(b);c="number"==typeof c?c:this.transIp(c);return(a&c)==(b&c)};this.checkDomain=function(a,b){var c=b?b:64;if(""==a)return E_BLANK;var d=/-{2}/;if(!/^((?:[a-zA-Z0-9]{0,63}|[a-zA-Z0-9][-a-zA-Z0-9]{0,61}[a-zA-Z0-9])\.)+(?:[a-zA-Z0-9]{0,63}|[a-zA-Z0-9][-a-zA-Z0-9]{0,61}[a-zA-Z0-9])$/.test(a)||
d.test(a))return E_DOMAINFORMAT;for(var d=a.split("."),e=0;e<d.length;e++)if(0==d[e].length||64<=d[e].length)return E_DOMAINFORMAT;return a.length>c?E_DOMAINLEN:E_NONE};this.checkDomainIp=function(a){return""==a?E_BLANK:"ip"==getInitType(a)?checkIp(a):checkDomain(a)};this.getInitType=function(a){if(""==a)return"unknown";a=a.charAt(0);return-1=="0123456789".indexOf(a)?"domain":"ip"}}(function(){Checks.call(window)})();
