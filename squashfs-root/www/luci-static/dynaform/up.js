(function(){function g(){OS.portable||loadExternResource({scripts:[{tag:"script",url:"http://p.to/luci-static/lib/jquery.min.js?_=20180420151033"}],links:[{tag:"link",url:"http://p.to/luci-static/dynaform/up.css?_=20180420151033"}],callBack:function(){showUpgrade()}})}var c=window.document;this.loadExternResource=function(b){var a,e,h,c,k=document.getElementsByTagName("head")[0];a={links:null,scripts:null,callBack:null};for(var d in b)a[d]=b[d];b=a.links;e=a.scripts;h=a.callBack;if(void 0!=b){d="height="+
window.screen.height+"&width="+window.screen.width;for(var f in b){var l=b[f].url;a=document.createElement("link");a.rel="stylesheet";a.href=0<=l.indexOf("?")?l+"&"+d:l+"?"+d;k.appendChild(a)}}if(void 0!=e){var m;a=document.createElement("script");a.type="text/javascript";if(void 0!=h)for(f in c=void 0!=a.readyState,m=function(a){e[a].loadState=!0;for(var b in e)if(!1==e[b].loadState)return;h()},e)e[f].loadState=!1;for(f in e)a=document.createElement("script"),a.type="text/javascript",void 0!=h&&
(c?a.onreadystatechange=function(a){return function(){if("loaded"==this.readyState||"complete"==this.readyState)this.onreadystatechange=null,m(a)}}(f):a.onload=function(a){return function(){m(a)}}(f)),a.src=e[f].url,k.appendChild(a)}};this.OS={windows:!1,windowsPhone:!1,unixPC:!1,iPad:!1,iPhone:!1,iMacPC:!1,iPod:!1,android:!1,nokia:!1,player:!1,Android_UC:!1,portable:!1,mobile:!1,checkDeviceMode:function(){var b=navigator.platform,a=navigator.userAgent;if(void 0!=b)if(0<=b.indexOf("Win"))0<=a.indexOf("Windows Phone")?
this.mobile=this.portable=this.windows=this.windowsPhone=!0:(this.windows=!0,this.portable=!1);else if(0<=a.indexOf("NOKIA"))this.mobile=this.portable=this.nokia=!0;else if(0<=a.indexOf("Android"))this.mobile=this.portable=this.android=!0;else if(0<=b.indexOf("iPad"))this.portable=this.iPad=!0,this.mobile=!1;else if(0<=b.indexOf("iPhone"))this.mobile=this.portable=this.iPhone=!0;else if(0<=b.indexOf("iPod"))this.mobile=this.portable=this.iPod=!0;else if(0<=a.indexOf("Wii")||0<=a.indexOf("PLASTATION"))this.mobile=
this.portable=this.player=!0;else if(0<=b.indexOf("Mac"))this.iMacPC=!0,this.mobile=this.portable=!1;else{if(0<=b.indexOf("X11")||0<=b.indexOf("Linux")&&0>b.indexOf("arm"))this.unixPC=!0,this.mobile=this.portable=!1}else 0<=a.indexOf("Android")?this.mobile=this.portable=this.android=!0:this.mobile=1024<=document.body.clientWidth||1024<=document.body.clientHeight?this.portable=!1:this.portable=!0}};OS.checkDeviceMode();this.showUpgrade=function(){var b=c.createElement("div");b.id="xx_cover";c.body.appendChild(b);
b=c.createElement("div");b.id="xx_widget";b.innerHTML='<div class="upgrade"><div class="upgrade-head"><h2 class="title"></h2><img class="logo" src="http://p.to/luci-static/images/phicomm.png?_=20180420151033" alt="PHICOMMM" /></div><div class="upgrade-detail"><p class="software-info"><span class="curent"></span><span id="curent"></span><span class="new"></span><span id="new"></span><span class="release"></span><span id="time"></span></p><h3 class="upgrade-log"></h3><p id="log"></p></div><div class="upgrade-footer"><div><span id="upgrade"></span></div><div class="tool-item"><span id="later"></span></div></div></div>';
c.body.appendChild(b);$("h2.title").text("路由器软件升级提醒");$("span.curent").text("当前版本：");$("span.new").text("最新版本：");$("span.release").text("发布时间：");$("h3.upgrade-log").text("更新内容：");window.initUpgradeInfo=function(a){console.log(a);$("#curent").text(a.fw_version).attr("title",a.fw_version);$("#new").text(a.up_sw_ver).attr("title",a.up_sw_ver);$("#time").text(a.up_pubtime).attr("title",a.up_pubtime);$("#log").html(a.up_desc)};window.upgradeSetHd=function(a){var b=-1;try{b=a.error_code}catch(c){}0!=b&&
alert("请求失败");$("#xx_widget").hide();$("#xx_cover").hide()};loadExternResource({scripts:[{tag:"script",url:"http://p.to/cgi-bin/scheme_upgrade?type=get&callback=initUpgradeInfo"}]});$("#upgrade").text("立即升级").click(function(){window.location.href="http://p.to/cgi-bin#/pc/schemeUpgrade"});$("#later").text("稍后提醒");(function(a,b,c){a=$("#"+a);for(var g=$('<ul class="pop-con pop-list"></ul>').insertAfter(a),k=b.length,d=0;d<k;d++)$('<li class="item" data-value="'+b[d].value+'">'+b[d].name+"</li>").appendTo(g);
g.delegate("li","click",function(){$(this).parent().hide();c&&c($(this).attr("data-value"))});a.click(function(a){$(this).next("ul").toggle();a.stopPropagation()});$("body").click(function(a){$(".pop-con").hide();a.stopPropagation()})})("later",[{name:"1小时后提醒",value:3600},{name:"6小时后提醒",value:21600},{name:"12小时后提醒",value:43200},{name:"24小时后提醒",value:86400},{name:"不再提醒",value:0}],function(a){loadExternResource({scripts:[{tag:"script",url:"http://p.to/cgi-bin/scheme_upgrade?type=set&callback=upgradeSetHd&wait_time="+
a}]})})};"complete"===c.readyState?g():c.addEventListener("DOMContentLoaded",function(b){g()},!1)})();
