function NiceScroll(g){this.taId=g;this.ta=id(this.taId);if(1!=this.ta.nodeType)return null;this.st=el("label");this.sb=el("div");this.sbcH=this.avg=this.stH=this.scH=this.sbH=0;this.n=20;this.enabled=!0;this.mousePos=null;this.show=this.onSb=this.isScroll=!1;this.wtId=this.checkTt=null;this.woSpeed=this.wSpeed=this.wtCounter=0;this.sbStyle={position:"fixed",zIndex:1005,width:"0.45em"};this.stStyle={width:"0.45em",display:"inline-block",backgroundColor:"#E7E7E7",borderRadius:"3px",position:"relative",
cursor:"pointer"};this.stOpacity=0.1;"function"!=typeof this.init&&(NiceScroll.prototype.init=function(){var c=this;this.sb.id=this.taId+"niceScrollSb"+(new Date).getTime();setStyle(this.sb,{backgroundColor:this.sbStyle.background||"transparent"});this.sb.appendChild(this.st);document.body.appendChild(this.sb);setStyle(this.sb,this.sbStyle);setStyle(this.st,this.stStyle);this._reset();!1==OS.portable?setStyle(this.ta,{overflow:"hidden"}):setStyle(this.ta,{overflow:"scroll"});this._shSb();this._bind();
window.setTimeout(function(){c.checkTt=window.setTimeout(arguments.callee,10);c._check()},100)},NiceScroll.prototype.scrollBarSet=function(c){if("object"==typeof c)for(var e in c)this.sbStyle[e]=c[e]},NiceScroll.prototype.scrollTipSet=function(c){if("object"==typeof c)for(var e in c)this.stStyle[e]=c[e]},NiceScroll.prototype.scrollTipOpacity=function(c){this.stOpacity=c},NiceScroll.prototype.scrollTo=function(c){c=parseInt(c);if(!0==isNaN(c))return!1;this.ta.scrollTop=c},NiceScroll.prototype._reset=
function(){var c=$(this.ta).offset(),e=this.ta.offsetWidth,b=this.ta.offsetHeight,a=this.ta.scrollHeight,l=parseFloat(getNodeDefaultView(this.ta,"borderTopWidth"))||0,d=parseFloat(getNodeDefaultView(this.ta,"borderBottomWidth"))||0,v=parseFloat(getNodeDefaultView(this.ta,"borderRightWidth"))||0;parseFloat(getNodeDefaultView(this.ta,"borderLeftWidth"));this.scH=a-b+l+d;this.stH=parseInt(0.7*(b/a)*b);this.sbcH=b-(this.stH+2);this.avg=this.scH/this.sbcH;0>=a-b?(setStyle(this.sb,{visibility:"hidden",
top:"-9999px"}),this.show=!1):(this.show=!0,setStyle(this.sb,{visibility:"visible"}),setStyle(this.sb,{top:c.top+l+"px",height:b+"px",left:c.left+e-v-parseInt(this.sb.offsetWidth)+"px"}),setStyle(this.st,{top:this.ta.scrollTop/this.scH*this.sbcH+"px",height:this.stH+"px"}))},NiceScroll.prototype._bind=function(){function c(a){a=a||window.event;var c=a.touches[0].clientY,d=c-b.mousePos.y,d=parseFloat(b.st.style.top)-d,d=d>=b.sbcH?b.sbcH:0>=d?0:d;b.st.style.top=d+"px";b.mousePos.y=c;b.isScroll=!0;!1==
OS.portable&&(b.ta.scrollTop=b.scH*(d/b.sbcH),eventPreventDefault(a));clearSelection(a)}function e(a){detachEvnt(document,"touchmove",c);detachEvnt(document,"touchend",e);!1==b.onSb&&(b.isScroll=!1)}var b=this;document.attachEvent?(this.ta.attachEvent("onmousewheel",function(a){a=a||window.event;b._scroll(a);a.cancelBubble=!0}),this.sb.attachEvent("onmousewheel",function(a){a=a||window.event;b._scroll(a);a.cancelBubble=!0})):(this.ta.addEventListener("mousewheel",function(a){a=a||window.event;b._scroll(a);
a.stopPropagation()},!1),this.ta.addEventListener("DOMMouseScroll",function(a){a=a||window.event;b._scroll(a);a.stopPropagation()},!1),this.sb.addEventListener("mousewheel",function(a){a=a||window.event;b._scroll(a);a.stopPropagation()},!1),this.sb.addEventListener("DOMMouseScroll",function(a){a=a||window.event;b._scroll(a);a.stopPropagation()},!1));attachEvnt(this.ta,"touchstart",function(a){a=a||window.event;b.mousePos={x:a.touches[0].clientX,y:a.touches[0].clientY};attachEvnt(document,"touchmove",
c);attachEvnt(document,"touchend",e)});this.st.onmousedown=function(a){b.mousePos=getMousePos(a);document.onmouseup=function(a){document.onmousemove=null;document.onmouseup=null;!1==b.onSb&&(b.isScroll=!1)};document.onmousemove=function(a){var d=getMousePos(a),c=d.y-b.mousePos.y,c=parseFloat(b.st.style.top)+c,c=c>=b.sbcH?b.sbcH:0>=c?0:c;b.st.style.top=c+"px";b.mousePos.y=d.y;b.ta.scrollTop=b.scH*(c/b.sbcH);b.isScroll=!0;clearSelection(a)}};$("#"+this.sb.id)[0].onmouseover=function(a){a=a||window.event;
b.onSb=!0;!0==b.show&&b._scrollShow(a)};$("#"+this.sb.id)[0].onmouseout=function(){b.onSb=!1;b.isScroll=!1}},NiceScroll.prototype._close=function(){this.sb.style.visibility="hidden";this.enabled=!1},NiceScroll.prototype._open=function(){this.enabled=!0},NiceScroll.prototype._shSb=function(){this.sb.style.visibility="none"==this.ta.style.display||"hidden"==this.ta.visibility?"hidden":"visible"},NiceScroll.prototype._check=function(){null==id(this.taId)?(window.clearTimeout(this.checkTt),this.sb.parentNode.removeChild(this.sb)):
!1!=this.enabled&&(!1==checkInHorize(this.ta)?this.sb.style.display="none":(this.sb.style.display="block",0>=parseInt(this.ta.offsetHeight)&&(this.sb.style.visibility="hidden"),this._reset()))},NiceScroll.prototype._getWheelDelta=function(c){c=c||window.event;return c.wheelDelta?window.opera&&9.5>window.opera.version?-c.wheelDelta:c.wheelDelta:40*-c.detail},NiceScroll.prototype._wheelAnimate=function(c,e){var b=this,a=!1;this.wtId?(this.wtCounter=(a=0>(this.woSpeed^c))?e:50>this.wtCounter+e?this.wtCounter+
e:50,this.wSpeed=a?c:1.05*this.wSpeed):(this.wtCounter=e,this.woSpeed=this.wSpeed=c,function(){var a=0;b.wtId=window.setTimeout(arguments.callee,5);if(0>b.wtCounter)clearTimeout(b.wtId),b.wtId=null,!1==b.onSb&&(b.isScroll=!1);else{a=parseFloat(b.ta.scrollTop)+parseInt(b.wSpeed);if(a>=b.scH||0>=a)b.wtCounter=0;b.ta.scrollTop=a;a=b.ta.scrollTop/b.scH*b.sbcH;isNaN(a)||(b.st.style.top=a+"px");b.wtCounter--}}())},NiceScroll.prototype._scrollShow=function(c){$("#"+this.sb.id).stop(!0).css("visibility",
"visible").css("opacity",1);this.isScroll=!0;eventPreventDefault(c)},NiceScroll.prototype._scroll=function(c){c=c||window.event;var e=0<this._getWheelDelta(c)?-1:1;!0==this.show&&!0==this.enabled&&(this._scrollShow(c),this._wheelAnimate(5*e,7))})}
function List(){this.initList=function(g,c,e){g=$("#"+g);for(var b=$('<ul class="pop-con pop-list"></ul>').insertAfter(g),a=c.length,l=0;l<a;l++)$('<li class="item" data-value="'+c[l].value+'">'+c[l].name+"</li>").appendTo(b);b.delegate("li","click",function(){$(this).parent().hide("fast");e&&e($(this).attr("data-value"))});g.click(function(a){$(this).next("ul").toggle("fast");a.stopPropagation()});$("body").click(function(a){$(".pop-con").hide("fast");a.stopPropagation()})}}
function Select(){this.initSelect=function(g,c,e,b,a){function l(a){for(var d,b,c=a.childNodes,f=0,h=c.length;f<h;f++)b=c[f],d=b.childNodes[0].style.visibility,b.style.backgroundColor="visible"==d?w:y,b.style.color="visible"==d?x:u;a.style.visibility="hidden";a.style.top="-9999px";a.parentNode.style.position="static"}function d(a){var d=id(g),c=a.parentNode,f=c.childNodes,h=$("#"+g+" span.value")[0];if(3!=a.childNodes[0].nodeType){d.value=a.valueStr;$("#"+g).attr("data-value",a.valueStr);h.value=
a.valueStr;for(var d=0,l=f.length;d<l;d++)f[d].childNodes[0].style.visibility="hidden",f[d].style.backgroundColor=y,f[d].style.color=u;"visible"!=a.childNodes[0].style.visibility&&"undefined"!=typeof b&&b(a.valueStr,!1);a.childNodes[0].style.visibility="visible";a.style.backgroundColor=w;a.style.color=x;h.innerHTML=htmlEscape(a.childNodes[1].nodeValue);c.style.visibility="hidden";c.style.top="-9999px";c.parentNode.style.position="static"}}function v(a){for(var b=0,c=a.length;b<c;b++){m=a[b];z=htmlEscape(m.name.toString());
n="hidden";h=document.createElement("li");if(void 0==m.value&&b==r||r==m.value)n="visible",p.innerHTML=z,p.value=r,q.value=r,$("#"+g).attr("data-value",r),h.style.backgroundColor=w,h.style.color=x;b==c-1&&(h.style.borderBottomWidth="0");h.innerHTML="<span style='visibility:"+n+"'><i class='selected-icon icon_confirm'></i></span>"+z;h.title=m.name;h.valueStr=void 0!=m.value?m.value:b;h.className="option";h.style.color=u;h.onclick=function(a){a=a||window.event;d(this);stopProp(a)};h.onmousemove=function(a){a=
a||window.event;a=a.srcElement||a.target;var d;if("span"!=a.tagName.toLowerCase()){d=a.parentNode.childNodes;for(var b=0,c=d.length;b<c;b++)d[b].style.backgroundColor=y,d[b].style.color=u;a.style.backgroundColor=w;a.style.color=x}};k.appendChild(h)}}function f(a){var d=$("#"+s+g);$("ul."+s).each(function(){"visible"==this.style.visibility&&l(this);return!0});d.css("visibility","visible").css("top","-1px");d[0].parentNode.style.position="relative";stopProp(a)}var h,m,p,n="hidden",k=document.createElement("ul"),
q=id(g),s="sel-opts-ul",y="#FFFFFF",w="#F0F0F0",u="",x="#4F5356",t,A,z,r=e;e=q.parentNode;t=$("#"+g+" span.value");u=t.css("color");p=t[0];p.value=0;A=parseInt(t.css("width"));t=(0.61*parseInt(t.css("fontSize"))).toFixed(1);void 0==a&&parseInt(A/t);q.value=0;k.className=s;k.id=s+g;e.appendChild(k);attachEvnt(document.body,"click",function(){var a=$("#"+s+g)[0];"undefined"!=typeof a&&l(a)});v(c);q.onclick=f;q.disable=function(a){q.onclick=!0==a?null:f;p.style.color=!0==a?"#DCDCDC":"#000000"};q.changeSel=
function(a){$("#"+s+g+" li");$("#"+s+g+" li").each(function(){if(this.valueStr==a)return d(this),!1})};q.resetOptions=function(a,d){k.innerHTML="";r=d||0;v(a)};b&&b(r,!0);c=new NiceScroll(k.id);c.scrollBarSet({width:"0.35em"});c.scrollTipSet({width:"0.35em"});c.init()}}
function DateControl(g,c,e,b){this.table;this.weekList;this.hourList;this.dateCon=id(g);this.weekIsMouseDown=!1;this.selDate=[0,0,0,0,0,0,0];this.dateArray=[0,0,0,0,0,0,0];this.cellSeColor="#85BD22";this.cellDeColor="#FAFAFA";this.cellPadding=1;this.selBegin={day:0,time:0,x:0,y:0};this.selEnd={day:0,time:0,x:0,y:0};this.selValue="1";this.canvas;this.tableBox;this.ctx;void 0==DateControl.prototype.init&&(DateControl.prototype.weekDayNum=7,DateControl.prototype.lineStr="-",DateControl.prototype.selTag=
"selTag",DateControl.prototype.cellBorderWidth=1,DateControl.prototype.iCellIndex=0,DateControl.prototype.weekArray=[label.Monday,label.Tuesday,label.Wednesday,label.Thursday,label.Friday,label.Saturday,label.Sunday],DateControl.prototype._init=function(){this._initOptions();this._dateConInit();this._weekListInit();this._hourListInit();this._dateTableInit();this._canvasInit()},DateControl.prototype.reset=function(a){var b,d,c,f=this.iCellIndex;if(!1!=a instanceof Array&&void 0!=a&&a.length==this.weekDayNum)for(var h=
0;h<this.weekDayNum;h++){d=this.table.rows[h];b=a[h];for(var m=0;24>m;m++)c=d.cells[m],c=c.childNodes[f],void 0!=b?(this._setSel(c,b%2),b>>=1):this._setSel(c,0)}},DateControl.prototype._initOptions=function(){for(var a in c)"undefined"!=typeof this[a]&&(this[a]=c[a])},DateControl.prototype.getSelDate=function(){var a,b,d=this.weekDayNum,c=this.table.rows;this.selDate=[0,0,0,0,0,0,0];for(var f=0;24>f;f++){b=c[f];for(var h=0;h<d;h++)a=b.cells[h],a=a.childNodes[0],a=parseInt(a.getAttribute("sel")),1==
a&&(this.selDate[h]|=Math.pow(2,f))}return this.selDate},DateControl.prototype._dateConInit=function(){this.dateCon.style.overflow="hidden"},DateControl.prototype._hourListInit=function(){var a=document.createElement("ul"),b,d,c=this;a.className="hourList";for(var f=0;24>=f;f++)b=document.createElement("li"),d=document.createElement("span"),d.innerHTML=10<=f?f+":00":"0"+f+":00",b.appendChild(d),d.onclick=function(a){return function(){if(!(23<a)){for(var d=c.table.rows[a].cells,b=c.iCellIndex,f=1,
k=0,e=d.length;k<e&&(f&=parseInt(d[k].childNodes[b].getAttribute("sel")),0!=f);k++);f=1-f;k=0;for(e=d.length;k<e;k++)c._setSel(d[k].childNodes[b],f);clearSelection()}}}(f),a.appendChild(b);this.dateCon.appendChild(a);this.hourList=a},DateControl.prototype._weekListInit=function(){var a=document.createElement("ul"),b,d=this;a.className="weekList";for(var c=0,f=this.weekDayNum;c<f;c++)b=document.createElement("li"),b.style.height=e+2*this.cellPadding+this.cellBorderWidth+"px",b.style.lineHeight=e+2*
this.cellPadding+this.cellBorderWidth+"px",b.innerHTML=this.weekArray[c],b.onclick=function(a){return function(){for(var b=d.table.rows,c=b.length,f=d.iCellIndex,e=1,l=0;l<c&&(e&=parseInt(b[l].cells[a].childNodes[f].getAttribute("sel")),0!=e);l++);e=1-e;for(l=0;l<c;l++)d._setSel(b[l].cells[a].childNodes[f],e);clearSelection()}}(c),a.appendChild(b);this.dateCon.appendChild(a);this.weekList=a},DateControl.prototype._setSel=function(a,b){a.setAttribute("sel",b);a.style.backgroundColor=1==b?this.cellSeColor:
this.cellDeColor},DateControl.prototype._dateCellCreate=function(){for(var a,c,d,g=0;24>g;g++){c=this.table.insertRow(-1);for(var f=0;f<this.weekDayNum;f++)a=c.insertCell(-1),a.style.padding=this.cellPadding+"px",a.className="weekTd",d=document.createElement("i"),d.className="tableICell",d.style.height=e+"px",d.style.width=b+"px",d.setAttribute("data-value",g+"."+f),a.appendChild(d),a=this.dateArray[f]>>g,this._setSel(d,a%2)}3==this.table.rows[0].cells[0].nodeType&&(this.iCellIndex=1)},DateControl.prototype._canvasInit=
function(){this._canvasCreate();this._canvasBind()},DateControl.prototype._canvasCreate=function(){var a=document.createElement("canvas");a.className="canvasDrag";a.id="CanvasDrag";this.dateCon.appendChild(a);this.canvas=a},DateControl.prototype._canvasBind=function(){function a(a){a.save();a.setTransform(1,0,0,1,0,0);a.clearRect(0,0,d.canvas.width,d.canvas.height);a.restore()}function b(a,c){var e,g;e=d.tableBox.width/7;g=d.tableBox.height/24;c.day=Math.floor((a.x-d.tableBox.x)/e);c.time=Math.floor((a.y-
d.tableBox.y)/g);c.day=6<c.day?6:c.day;c.day=0>c.day?0:c.day;c.time=23<c.time?23:c.time;c.time=0>c.time?0:c.time}var d=this;d.canvas.onmousedown=function(c){d.tableBox=d.table.getBoundingClientRect();d.tableBox.x=d.tableBox.left;d.tableBox.y=d.tableBox.top;d.ctx=d.canvas.getContext("2d");d.canvas.width=d.tableBox.width;d.canvas.height=d.tableBox.height;d.weekIsMouseDown=!0;!0==d.weekIsMouseDown&&(d.selBegin.x=c.x,d.selBegin.y=c.y,document.onmousemove=function(b){if(!0==d.weekIsMouseDown){d.selEnd.x=
b.clientX;d.selEnd.y=b.clientY;a(d.ctx);b=d.ctx;var c=d.selBegin,e=d.selEnd,g=d.tableBox;b.strokeStyle="#00";b.lineWidth=1;b.beginPath();b.moveTo(c.x-g.x,c.y-g.y);b.lineTo(c.x-g.x,e.y-g.y);b.lineTo(e.x-g.x,e.y-g.y);b.lineTo(e.x-g.x,c.y-g.y);b.closePath();b.stroke()}},document.onmouseup=function(c){if(!0==d.weekIsMouseDown){d.selEnd.x=c.clientX;d.selEnd.y=c.clientY;a(d.ctx);b(d.selEnd,d.selEnd);b(d.selBegin,d.selBegin);c=d.selBegin.day>d.selEnd.day?d.selEnd.day:d.selBegin.day;var e=d.selBegin.day>
d.selEnd.day?d.selBegin.day:d.selEnd.day,g=d.selBegin.time>d.selEnd.time?d.selEnd.time:d.selBegin.time,p=d.selBegin.time>d.selEnd.time?d.selBegin.time:d.selEnd.time;d.reset();d.selValue=0;for(var n=c;n<=e;n++)for(var k=g;k<=p;k++)if(0==d.table.rows[k].cells[n].childNodes[d.iCellIndex].getAttribute("sel")){d.selValue=1;break}for(n=c;n<=e;n++)for(k=g;k<=p;k++)d._setSel(d.table.rows[k].cells[n].childNodes[d.iCellIndex],d.selValue)}d.weekIsMouseDown=!1})}},DateControl.prototype._dateTableCreate=function(){this.table=
document.createElement("table");this.table.className="tableWeek";this.table.cellspacing="0px";this.table.cellpadding="0px";this.dateCon.appendChild(this.table)},DateControl.prototype._dateTableInit=function(){this._dateTableCreate();this._dateCellCreate()});this._init()}(function(){Select.call(window);List.call(window)})();
