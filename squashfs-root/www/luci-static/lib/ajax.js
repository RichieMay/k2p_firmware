function Basic(){this.w=window;this.routerAlive=!1;this.head=document.getElementsByTagName("head")[0];this.d=document;this.local="file:"==location.protocol;this.isIE=0<=navigator.userAgent.indexOf("IE");this.domainUrl="http://p.to";this.time=1E3;this.explorerTag=0;this.UA="h5";this.httpTag="http://";this.ajaxAsyn=!0;this.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};this.getExplorer=function(){var a=navigator.userAgent;0<a.indexOf("IE 6.0")?this.explorerTag=6:0<a.indexOf("IE 7.0")&&
(this.explorerTag=7);this.UA=OS.mobile?"h5":"pc"};this.transText=function(a){if(0<a.length){a=a.substring(a.indexOf("\r\n")+2);try{return eval("("+a+")")}catch(b){return""}}};this.id=function(a){return document.getElementById(a)};this.changeDomain=function(a){var b=this.httpTag;this.domainUrl=0<=a.indexOf(b)?a:b+a};this.initUrl=function(){if(!this.local){var a=location.href.match(/[a-z0-9][-a-z0-9]{0,62}(\.[a-z0-9][-a-z0-9]{0,62})+\.?/i);null!=a&&(this.domainUrl=this.httpTag+a[0])}};this.objInitNull=
function(a){for(var b in a)"object"==typeof a[b]?this.arguments.callee(a[b]):a[b]=""};this.objSet=function(a,b){if(this.isArray(b)){var d=0,c;for(c in a)a[c]=b[d++]}else for(c in a)a[c]=b};this.objCopy=function(a,b){var d,c;for(c in a)d=b[c],void 0!=d&&(a[c]=d)};this.encodePara=function(a){return a=encodeURL(a.toString())}}
function WebAjax(){this.local="file:"==location.protocol;this.isIE=0<=navigator.userAgent.indexOf("IE");this.ajaxTimeout=2E3;this.session="";this.sessionKey="stok";this.externDataParseFunc=new Function;this.result={errorno:0,data:"",timeout:!0};this.initResult=function(a){this.result.errorno=0;this.result.data="";this.result.timeout=!0};this.initSession=function(){try{sessionLS.getItem(this.sessionKey)}catch(a){}this.session=sessionLS.getItem(this.sessionKey)};this.setSession=function(a){this.session=
a;try{sessionLS.setItem(this.sessionKey,a)}catch(b){}};this.setDataParseFunc=function(a){this.externDataParseFunc=a};this.changeAsynTime=function(a){this.ajaxTimeout=a};this.getValueFromUrl=function(a,b){var d="",c;b+="=";c=a.indexOf(b);0<=c&&(d=a.substring(c+b.length),c=d.indexOf("&"),c=0<c?c:d.length,d=d.substring(0,c));return d};this.orgURL=function(a){var b=location.href,d=b.indexOf("#");0<=d&&(a=$.session&&0!=$.session.length?b.substring(0,d)+"/stok="+encodeURIComponent($.session)+a:b.substring(0,
d)+a);return a};this.request=function(a,b,d,c,g,e,h,l){function m(a){var b,c;try{c=JSON.parse(a,function(a,b){var c=b;if("string"===typeof c)try{c=decodeURIComponent(c)}catch(d){}return c})}catch(d){c=null}null==c?b=E_NONE:(b=c[ERR_CODE],a=c.data);return[b,a]}var f=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest,n,k=this;this.initResult(k.result);f.onreadystatechange=function(){if(4==f.readyState&&(!0===$.local||100<=f.status)){k.result.timeout=!1;if(n=f.responseText)k.result.data=
n;var a=m(n);k.result.errorno=a[0];k.result.data=a[1];void 0!=g&&g(k.result);return!0}};try{void 0!=h&&void 0!=l?f.open(d,a,c,h,l):f.open(d,a,c),f.setRequestHeader("If-Modified-Since","0"),void 0!=b?f.send(b):f.send(null)}catch(p){}}}
function Load(){Basic.call(this);WebAjax.call(this);this.asyn=!0;this.syn=!1;this.detectTime=1E3;this.div=document.createElement("div");this.externResizefunc=new Function;this.externJSP=new Function;this.responsiveCSS=new Function;this.externLoading=new Function;this.externPageHandle=new Function;this.pageTickArray=[];this.pageCycleArray=[];this.scriptArray=[];this.unAuthCode=401;this.httpOK=200;this.setTimeout=function(a,b){var d=window.setTimeout(a,b);this.pageTickArray.push(d);return d};this.setInterval=
function(a,b){var d=window.setInterval(a,b);this.pageCycleArray.push(d);return d};this.addScript=function(a){if(a&&/\S/.test(a)){var b=this.d.createElement("script");b.type="text/javascript";void 0===b.text?b.appendChild(this.d.createTextNode(a)):b.text=a;this.head.insertBefore(b,this.head.firstChild);this.head.removeChild(b)}};this.getNodeArray=function(a,b){for(var d=[],c=0,g=a.length;c<g;c++)d[c]=a[c];b(d)};this.addDomNode=function(a,b,d){var c=this;this.div.innerHTML="div"+b;this.div.removeChild(this.div.firstChild);
this.getNodeArray(this.div.childNodes,function(b){a&&(a.innerHTML="");if(d){for(var e=0,h=c.pageTickArray.length;e<h;e++)try{window.clearTimeout(c.pageTickArray.shift())}catch(l){}e=0;for(h=c.pageCycleArray.length;e<h;e++)try{window.clearTimeout(c.pageCycleArray.shift())}catch(m){}}for(var f=[],e=0,h=b.length;e<h;e++)1==b[e].nodeType&&"script"===b[e].nodeName.toLowerCase()?f.push(b[e]):a.appendChild(b[e]);e=0;for(h=f.length;e<h;e++)c.addScript(f[e].text||f[e].textContent||f[e].innerHTML||"")})};this.pageResize=
function(){this.externResizefunc()};this.setPageResize=function(a){this.externResizefunc=a};this.setexternJSP=function(a){this.externJSP=a};this.setResponsiveCSS=function(a){this.responsiveCSS=a};this.setExternLoading=function(a){this.externLoading=a};this.setExternPageHandle=function(a){this.externPageHandle=a};this.append=function(a,b,d){a&&1==a.nodeType&&"string"===typeof b&&(this.addDomNode(a,b,d),this.pageResize())};this.detectWidthImg=function(a){var b=new Image;b.onload=function(){a()};b.src=
this.domainUrl+"/luci-static/images/favicon.ico?requence="+Math.random()};this.detect=function(a){!0==isIETenLess?this.detectWidthImg(a):this.request(this.domainUrl+"/luci-static/images/nothing.png?_=20180420151033",void 0,"get",this.asyn,a,2E3)};this.loadHand=function(a,b,d){var c=this.externJSP(a.data);void 0!=c&&(a.data=c);c=this.responsiveCSS(a.data);void 0!=c&&(a.data=c);if(this.unAuthCode!=a.errorno){this.append(this.id(b),a.data,d);try{this.externPageHandle(b)}catch(g){}}};this.load=function(a,
b,d,c){function g(a){(h=a.timeout)||l.loadHand(a,d,!1!==c);b&&b(a)}function e(a){switch(a){case E_SYSRESET:$.setSession("");stateman.go("guide");break;case E_SESSIONTIMEOUT:$.setSession("");showAlert(label.loginTimeout,function(a){stateman.go("login")});break;case E_UNAUTH:$.setSession("");stateman.go("login");break;default:showAlert(errStr.unknownErr+a)}}var h=!1,l=this;if(this.local||void 0!=b)this.loadAsyn(a,this.ajaxTimeout,function(a){var b=E_NONE;try{b=a.errorno}catch(c){}b!=E_NONE?e(b):g(a)});
else{this.request(this.orgURL(a),void 0,"get",this.syn);a=E_NONE;try{a=result.errorno}catch(m){}a!=E_NONE?e(a):g(this.result)}return h};this.loadAsyn=function(a,b,d){this.request(this.orgURL(a),void 0,"get",this.asyn,d,b)};this.sendAjax=function(a,b,d,c){var g;b=b||{};b._deviceType=OS.deviceType;g=JSON.stringify(b,function(a,b){return"string"===typeof b?encodeURIComponent(b):b});a=this.orgURL(a);jQuery.ajax({url:a,data:g,type:c||"post",contentType:"application/json",success:function(a){switch(a[ERR_CODE]){case E_SYSRESET:$.setSession("");
stateman.emit("reset");break;case E_SESSIONTIMEOUT:$.setSession("");showAlert(label.loginTimeout,function(a){stateman.go("login")});break;case E_UNAUTH:$.setSession("");stateman.go("login");break;default:"function"===typeof d&&d(a)}},error:function(c,d,g){console.error("sendAjax error:"+a+", data:"+JSON.stringify(b));console.error(g)}})}}jQuery.ajaxSetup({converters:{"text json":function(a){return JSON.parse(a,function(a,d){var c=d;if("string"===typeof c)try{c=decodeURIComponent(c)}catch(g){}return c})}}});
